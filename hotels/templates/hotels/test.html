{% extends "hotels/base.html" %}
{% load static %}
{% block content %}
{% load widget_tweaks %}
{% load my_filters %}
{% load humanize %}


<!-- start Main Wrapper -->
		<div class="main-wrapper scrollspy-action">

			<div class="page-title breadcrumb-wrapper">
				<div class="container">
					<nav aria-label="breadcrumb">
						<ol class="breadcrumb">
							<li class="breadcrumb-item"><a href="{% url 'bookings-home'%}">Home</a></li>
							<li class="breadcrumb-item"><a href="{% url 'package-list'%}">Packages</a></li>
							<li class="breadcrumb-item"><a href="{% url 'package-detail' object.slug %}">{{ object.title }}</a></li>
						</ol>
					</nav>
				</div>
			</div>

			<div class="page-wrapper page-detail bg-light">

				<div class="detail-header">

					<div class="container">

						<div class="d-flex flex-column flex-lg-row">

							<div>
								<h2 id="detail-content-sticky-nav-00" class="name">{{ object.title }}</h2>


								<div class="star-rating-wrapper">
									<div class="rating-item rating-inline">
										<div class="rating-icons">
											<input type="hidden" class="rating" data-filled="rating-icon fas fa-star rating-rated" data-empty="rating-icon far fa-star" data-fractions="2" data-readonly value="4.5"/>
										</div>
									</div>
								</div>

								<div class="clear"></div>

								


							</div>
              {% if user.is_authenticated and object.contact_person == user %}
							<div class="ml-lg-auto text-left text-lg-right mt-20 mt-lg-0">

								<a href="#" class="anchor btn btn-primary btn-wide mt-5">Update Package Details</a>
                <a href="#" class="anchor btn btn-danger btn-wide mt-5">Delete</a>
                {% else %}

								<div class="ml-lg-auto text-left text-lg-right mt-20 mt-lg-0">
									{% for key, value in lowest_prices.items %} 
                                    {% if key == object.title %}
									<div class="price">from <span>Ksh<span>{{ value|intcomma }}</span></span></div>
									{% endif %}
									{% endfor %}

								
                <a href="#detail-content-sticky-nav-02" class="anchor btn btn-primary btn-wide mt-5">See price and date</a>
                {% endif %}

							</div>

						</div>

					</div>

				</div>

				<span  id="detail-content-sticky-nav-00" class="d-block"></span>

				<div class="fullwidth-horizon-sticky d-none d-lg-block">

					<div class="fullwidth-horizon-sticky-inner">

						<div class="container">

							<div class="fullwidth-horizon-sticky-item clearfix" style="text-align:center!important;">

								<ul id="horizon-sticky-nav" class="horizon-sticky-nav clearfix" >
									<li>
										<a href="#detail-content-sticky-nav-00">Gallery</a>
									</li>
									<li>
										<a href="#detail-content-sticky-nav-02">Available hotels</a>
									</li>
									<li>
										<a href="#detail-content-sticky-nav-03">What's nearby</a>
									</li>
									<li>
										<a href="#detail-content-sticky-nav-04">Facilities</a>
									</li>
									<li>
										<a href="#detail-content-sticky-nav-05">Itinirary</a>
									</li>
									<li>
										<a href="#detail-content-sticky-nav-06">Reviews</a>
									</li>
								</ul>

							</div>

						</div>
					</div>
				</div>

				<div class="container">

					<div class="row gap-30">

						<div class="col-12 col-lg-8 col-xl-9" style="margin:auto!important;">

							<div class="content-wrapper">

								<div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
  <ol class="carousel-indicators">
  	{% for i in object.itinirery_set.all %}
    <li data-target="#carouselExampleIndicators" data-slide-to="{{ forloop.counter }}"
    {% if forloop.first %}class="active"{% endif %}>	
    </li>
    {% endfor %}
  </ol>

  <div class="carousel-inner">
  	 {% for i in object.itinirery_set.all %} 
    <div class="carousel-item {% if forloop.first %}active{% endif %}">
    <img src="{{ i.package_photo.url }}" class="d-block w-100" alt="{{ object.name }} photo"> 

  </div>{% endfor %}

</div>
  <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    <span class="sr-only">Previous</span>
  </a>
  <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
    <span class="sr-only">Next</span>
  </a>
</div>

								<div id="detail-content-sticky-nav-01" class="fullwidth-horizon-sticky-section">

									<h3 class="heading-title"><span>Overview</span></h3>

									<p><span class="text-primary font700"><i class="fa fa-thumbs-o-up"></i> </span> {{ object.description }}</p>
								</div>

								<div id="detail-content-sticky-nav-02" class="fullwidth-horizon-sticky-section">
	
									<h3 class="heading-title"><span>Available Hotels for this Package</span></h3>

									
									<div class="room-item-wrapper">

										<div class="room-item heading d-none d-md-block">

											<div class="row gap-20">

												<div class="col-xs-12 col-sm-12 col-md-6">

													<div class="row gap-20">

														<div class="col-xss-6 col-xs-3 col-sm-4 col-md-4">

														</div>

														<div class="col-xss-12 col-xs-9 col-sm-8 col-md-8">
															<span>Hotel</span>
														</div>

													</div>

												</div>

												<div class="col-xs-12 col-sm-8 col-sm-offset-4 col-md-6 col-md-offset-0">

													<div class="row gap-20">

														<div class="col-xs-12 col-sm-8 col-md-8">
															<span>Hotel option</span>
														</div>

														<div class="col-xs-12 col-sm-4 col-md-4">
															<span>No. persons</span>
														</div>

													</div>

												</div>

											</div>

										</div>
                    {% for item in object.hotelpackages_set.all %}
										<div class="room-item">

											<div class="row gap-20">

												<div class="col-12 col-sm-12 col-md-6">
													<div class="row gap-20">

														<div class="col-6 col-sm-4 col-md-4">
															<div class="image">
																<img src="{{ item.hotel.property_photo.url }}" alt="{{ item.hotel.name }}" />
															</div>
															<p></p>
															
															{% for list in item.meals_as_list %}
															<span class="icon-font"><i class="fas fa-check-circle text-primary"></i> {{ list }} </br></span> {% endfor %}
														</div>


														<div class="col-12 col-sm-8 col-md-8">
															<div class="content">
																<h5><a href="#">{{ item.hotel.name }} </a></h5>
																<p><span class="font700">{{ item.hotel.address }},
																	{{ item.hotel.city }}</span></p>
																	<p><span class="font700">Validity:</span>
																	 {% if item.is_past_due %}<span class="number text-secondary">
																		Offer Expired!</span>
																		{% else %}

																	{{ item.start_Date|date:"M d" }} - {{ item.end_Date|date:"M d" }} {% endif %}</p>
																	
																
														
																<p class="price"><span class="number text-secondary"><small>Ksh</small>{{ item.package_Price|intcomma }}</span> pps</p>
															</div>
														</div>

													</div>
												</div>

												<div class="col-12 col-md-6" >

													<div class="row gap-20 justify-content-between">
                            <form method="POST" action="{% url 'package-booking'  item.id %}" class='pull-right'>
															{% csrf_token %}
														<div  id="airDatepickerRange-general"  class="col-7 col-sm-8 col-md-8">

															<div class="form-group">
																<label class="line12 font13 spacing-05 mt-5 mb-10 block">Check-in</label>
																<div class="form-icon-left">
																	<span class="icon-font text-muted"><i class="bx bx-calendar"></i></span>
																	<input type="text" name='checkin'id="dateStart-general" class="form-control form-readonly-control" placeholder="dd/mm/yyyy" required>
																</div>
															</div>

														</div>

														<div class="col-5 col-sm-4 col-md-4">

															<div class="form-group form-spin-group mb-5">
																<label class="line12 font13 spacing-05 mt-5 mb-10 block">How many people?</label>
																<div class="form-icon-left">
																	<span class="icon-font"><i class="dripicons-user text-muted"></i></span>
																	<input name='qty' class="form-control touch-spin-03 form-readonly-control" value="1" readonly required/>
																	</div>
																	<label class="line12 font13 spacing-05 mt-5 mb-10 block">Reserve</label>
																	<label class="line12 font13 spacing-05 mt-5 mb-10 block"></label>

																	<button type="submit" class="btn btn-primary btn-sm btn-block">Book</button>
															</div>


														</div>

													</div>

												</div>

											</div>

										</div>
									</form>
                    {% endfor %}

									</div>

								</div>


								<div id="detail-content-sticky-nav-05" class="fullwidth-horizon-sticky-section">

									<h3 class="heading-title"><span>{{ object.title }} Itinerary</span></h3>

									<div class="feature-box-2 mb-0 bg-white">
                                       {% for ite in object.itinirery_set.all %}
										<div class="feature-row">
											<div class="row gap-10 gap-md-30">

												<div class="col-12 col-sm-4 col-md-3">
													<h6>{{ ite.title }}</h6>
												</div>

												<div class="col-12 col-sm-8 col-md-9">
													<p>{{ ite.description }}</p>
												</div>

											</div>
										</div>
										{% endfor %}

								</div>

								<div id="detail-content-sticky-nav-06" class="fullwidth-horizon-sticky-section">

									
								</div>

							</div>
						</div>

						<div  class="col-12 col-lg-4 col-xl-3">

						</div>

					</div>
					<div class="fullwidth-horizon-sticky border-0">&#032;</div> <!-- is used to stop the above stick menu -->

				</div>

			</div>

			<section class="bg-white section-sm">

				<div class="container">

					<div class="section-title mb-25">

						<h3>You may also like</h3>

					</div>

					<div class="row equal-height cols-1 cols-sm-2 cols-lg-3 gap-10 gap-lg-20 gap-xl-30">
						{% for package in packages|slice:":3"  %}
						{% if package.city == object.city %}
						
						<div class="col">
							

							<div class="product-grid-item">

								<a href="{% url 'package-detail' package.slug  %}">

									<div class="image">
										<img src="{{package.cover_photo.url}}" alt="Image">
									</div>

									<div class="content clearfix">

										<div class="rating-item rating-sm">
											<div class="rating-icons">
												<input type="hidden" class="rating" data-filled="rating-icon fas fa-star rating-rated" data-empty="rating-icon far fa-star" data-fractions="2" data-readonly value="4.0"/>
											</div>
											<p class="rating-text text-muted"><span class="bg-primary">6.0</span> <strong class="text-dark">Good</strong> - 1,2547 reviews</p>
										</div>

										<div class="short-info">

											<h5>{{ package.title }}</h5>
											<p class="location"><i class="fas fa-map-marker-alt text-primary">
												
											</i> {{ package.city}}, {{ package.country}}</p>

										</div>

										<div class="price">
											<div class="float-right">
												start from
												{% for key, value in lowest_prices.items %} 
                                                 {% if key == package.title %}
												<span class="text-secondary">Ksh{{ value|intcomma }}</span>
												{% endif %}
												{% endfor %}
												per person
											</div>
										</div>

									</div>

								</a>

							</div>
							

						</div>
						{% endif %}
						{% endfor %}
						

						</div>

					

				</div>

			</section>

		</div>
		<!-- end Main Wrapper -->

{% endblock content %}
